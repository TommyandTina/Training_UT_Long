# Test Tool
Test tool is used to generate test program from test specification.

## Requirement
OS: Window 10
Program:
    Python 3.7.8
    Python package openpyxl 3.0.4

## Install python
Install python version 3.7.8 in this link
'''
https://www.python.org/ftp/python/3.7.8/python-3.7.8-amd64.exe
'''
After install python, set environment path to
'''
C:\Python
C:\Python\Scripts
'''
Install python package
'''
python -m pip install openpyxl 3.0.4
'''

## Stub
There are 3 module for generate stub test program.
Used sequence Module 1 -> Module 2 -> Module 3

Module 1:
  Name: stub_LocalFuncToStub.py
  Input:
    -i :Source.c path
    -static :true if you want to define static function with stub function
             false if vice-versa
    -module :module name
  Output:
    -o :Output directory of source code that define local function with stub function, file name ut_Source.c
    List of local function, file name local_function.txt
    List of static function, file name static_function.txt
  Description:
    This module create a source file(.c) that define local function with stub function.

Module 2:
  Name: stub_FindPrototype.py
  Input:
    -i :Module directory for searching file .h and .c
    List of local function, file name local_function.txt that generated by Module 1
    List of static function, file name static_function.txt that generated by Module 1
  Output:
    List of function prototype, file name function_prototype.txt
  Description:
    This module find local function prototype in header file .h in input module directory and
    find static function prototype in source file .c in input module directory

Module 3:
  Name: stub_FindPrototype.py
  Input:
    -module :module name
    List of function prototype, file name function_prototype.txt that generated by Module 2
  Output:
    -o :Output directory of hook.c, stub.c and include/stub.h
  Description:

Usage with .bat
'''
@echo off

call del local_function.txt
call del static_function.txt

set MODULE=imr
set OUT_DIR="a050b/ut_framework/base/imr_stub"

call mkdir %OUT_DIR%
call mkdir %OUT_DIR%\include

set SOURCE_PATH="C:/repo/s920c/RTOS/BSP/imr/src/osal/r_imr_osal_msg.c"
call python ../src/Stub/stub_LocalFuncToStub.py -i %SOURCE_PATH% -o %OUT_DIR% -static true -module %MODULE%

set SOURCE_PATH="C:/repo/s920c/RTOS/BSP/imr/src/osal/r_imr_osal_sem.c"
call python ../src/Stub/stub_LocalFuncToStub.py -i %SOURCE_PATH% -o %OUT_DIR% -static true -module %MODULE%

set MODULE_DIR=
set MODULE_DIR=%MODULE_DIR%"C:/repo/s920c/RTOS/BSP/imr"
set MODULE_DIR=%MODULE_DIR%"C:/repo/s920c/RTOS/OSAL"
call python ../src/Stub/stub_FindPrototype.py -i %MODULE_DIR%

call python ../src/Stub/stub_StubAndHook.py -o %OUT_DIR% -module %MODULE%
'''
